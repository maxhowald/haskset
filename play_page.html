<!DOCTYPE html>
<html lang="en">
<title>A+ SET Project</title>

<head>
<link rel="stylesheet" type="text/css" href="style.css">
<link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
<link rel="icon" type="image/x-icon" href="favicon.ico">

<script type="text/javascript" href="jquery-1.11.2">
Image1 = new Image(150,100); //do one of these for each.
Image1.src = "1.gif";

/////////////////////////////////////
//$(document).ready(function(){});
//onclick="dealCards('21,22,23,24,25,26,27,28,29,30,31,32,33,34,35')"
////////////////////////////////////
var toSubmit = "";
var isHighlighted = [];
var isDealt = false;

function dealCards(cardString, isReset){
	isDealt = true;
	var i = 1;
	var j = 1;
	var card;
    var prefix = "images/"
	if (isReset == true){
		isHighlighted = [];
	}
	while (cardString.length != 0){
		var comma = cardString.indexOf(",");
		var name = "slot" + i + j;
		if (isReset == true){
			document.getElementById(name).className = "card";
		}
		if (comma == -1){
			card = cardString.slice(0);
			document.getElementById(name).src = prefix + card + ".gif";
			document.getElementById(name).tag = card;
			break;
		}
		else if(i == 4){	//for extra cards
			i = 1;
			while (i<4){
				if (isReset == true){
					document.getElementById(name).className = "card";
				}
				card = cardString.slice(0, comma);
				document.getElementById("extraCard" + i).style.display = "inline";
				document.getElementById("extraCard" + i).src = prefix + card + ".gif";
				document.getElementById("extraCard" + i).tag = card;
				cardString = cardString.substr(comma + 1);
				i++;
			}
		}
		
		//TO DO. MAKE AN ELSE IF (i == 5) FOR EXTRA CARDS.
		
		else{			
			card = cardString.slice(0, comma);
			document.getElementById(name).src =  prefix + card + ".gif";
			document.getElementById(name).tag = card;
			cardString = cardString.substr(comma + 1);
		}
		
		if (j == 4){
			j = 1;
			i++;
		}
		else{
			j++;
		}
	}
}

function insertPlayer(username, rating){
	//if (username.length() > 10){}
	var table = document.getElementById("scoreTable");
	var row = table.insertRow(0);
	nameCell = row.insertCell(0);
	rateCell = row.insertCell(1);
	scoreCell = row.insertCell(2);
	nameCell.className = "username";
	rateCell.className = "rating";
	scoreCell.className = "score";
	nameCell.innerHTML = username;
	rateCell.innerHTML = "(" + rating + ")";
	scoreCell.innerHTML = 0;
}

function submitCards(){
	var selected = isHighlighted.valueOf();
	alert(selected);
}

function highlight(slot, card){
    var done = false;
		console.log("called highlight on " + card);
		if (isHighlighted.length > 0){
			for(index = 0; index < isHighlighted.length; index++){
				console.log("loopcheck " + index + " :" + isHighlighted[index]);
				if (isHighlighted[index] == card){
					console.log("we're getting here");
					var done = true;									 
					document.getElementById(slot).className = "card";
					isHighlighted.splice(index, 1);
				}
      }

}

	 if (done == false) {
					if (isHighlighted.length < 3){
						document.getElementById(slot).className = "selectedCard";
						isHighlighted.push(card);
					
				  	}
				 }

		


		if (isHighlighted.length == 3){
			document.getElementById("submit").disabled = false;
		}
		else{
			document.getElementById("submit").disabled = true;
		}
}

//still need to make function that rearranges scoreboard when message recieved.
</script>
</head>

	<body>
		<div id="wrapper">
			<table id="main_table">
				<tr>
					<td rowspan="2" style="text-align: center;">
						<table id="card_table">
							<tr>
								<td>
									<img id="slot11" class="card" onclick="highlight(this.id, this.tag)">
								</td>
								<td>
									<img id="slot12" class="card" onclick="highlight(this.id, this.tag)">
								</td>
								<td>
									<img id="slot13" class="card" onclick="highlight(this.id, this.tag)">
								</td>
								<td>
									<img id="slot14" class="card" onclick="highlight(this.id, this.tag)">
								</td>
								<td>
									<img id="extraCard1" style="display:none;" class="card" onclick="highlight(this.id, this.tag)">
								</td>
							</tr>
							<tr>
								<td>
									<img id="slot21" class="card" onclick="highlight(this.id, this.tag)">
								</td>
								<td>
									<img id="slot22" class="card" onclick="highlight(this.id, this.tag)">
								</td>
								<td>
									<img id="slot23" class="card" onclick="highlight(this.id, this.tag)">
								</td>
								<td>
									<img id="slot24" class="card" onclick="highlight(this.id, this.tag)">
								</td>
								<td>
									<img id="extraCard2"  style="display:none;" class="card" onclick="highlight(this.id, this.tag)">
								</td>
							</tr>
							<tr>
								<td>
									<img id="slot31" class="card" onclick="highlight(this.id, this.tag)">
								</td>
								<td>
									<img id="slot32" class="card" onclick="highlight(this.id, this.tag)">
								</td>
								<td>
									<img id="slot33" class="card" onclick="highlight(this.id, this.tag)">
								</td>
								<td>
									<img id="slot34" class="card" onclick="highlight(this.id, this.tag)">
								</td>
								<td>
									<img id="extraCard3"  style="display:none;" class="card" onclick="highlight(this.id, this.tag)">
								</td>
							</tr>	
							<tr>
								<td colspan="5" style="height: auto;">
									<button id="submit" type="button" disabled class="button" onclick="submitCards()"> Set! </button>
								</td>
							</tr>
						</table>
					</td>
					<td id="scoreBox">
						<table id="scoreTable">
						</table>
					</td>
				</tr>

				<tr>
					<td id="chat">
						Chat goes here.
						<button type="button" class="button" onclick="dealCards('21,22,23,24,25,26,27,28,29,30,31,32,33,34,35')"> Deal Cards </button>
					</td>
				</tr>
			</table>
		</div>
</body>
</html>
